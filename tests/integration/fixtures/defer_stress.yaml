esphome:
  name: defer-stress-test

external_components:
  - source:
      type: local
      path: EXTERNAL_COMPONENT_PATH
    components: [defer_stress_component]

host:

logger:
  level: VERBOSE

defer_stress_component:
  id: defer_stress

api:
  services:
    - service: run_stress_test
      then:
        - lambda: |-
            id(defer_stress)->run_multi_thread_test();

event:
  - platform: template
    name: "Test Complete"
    id: test_complete
    device_class: button
    event_types:
      - "test_finished"
  - platform: template
    name: "Test Result"
    id: test_result
    device_class: button
    event_types:
      - "passed"
      - "failed"
